{% extends 'base.html' %}
{% load yannnju_filter %} <!--markdown ì‚¬ìš©ì í•„í„° ì •ì˜-->

{% block content %}

<div class='container my-3'>
    <!--ì‚¬ìš©ì ì˜¤ë¥˜ í‘œì‹œ-->
    <div>
        {% if messages %}
            <div class='alert alert-danger my-3' role = 'alert'>
                    {% for message in messages %}
                        <strong>{{message.tag}}</strong>
                        <ul><li>{{message.message}}</li></ul>
                    {% endfor %}
            </div>
        {% endif %}
    </div>

    <h2 class = "border-bottom py-2">
        <i class="fa-solid fa-person-circle-question"></i>
        {{question.subject}} ~(>_<ã€‚)ï¼¼
    </h2>
    <span>
        ì‘ì„±ì : 
        <strong>
            {{question.auth.username}}
        </strong>
    </span>
    {% if request.user == question.auth %}
        <span class='mx-3'>
            {% comment %} '{% url 'yannjuName:question_modify question.id ' %}' {% endcomment %}
            <a href ='{% url 'yannjuName:question_modify' question.id  %}' class='btn btn-dark'>ìˆ˜ì •</a>
        </span>
        <span >
            <a href ='#' class='delete btn btn-sm btn-danger' data-uri = "{% url 'yannjuName:question_delete' question.id %}">ì‚­ì œ</a>
        </span>
    {% endif %}

    <!--ì¶”ì²œ ê¸°ëŠ¥ì„ ìœ„í•œ grid ì ìš©-->
    <div class = 'row my-3'>
        <div class='col-1'>
            <!--ì¶”ì²œ ì˜ì—­-->
            <div class = 'bg-light text-center p-3 border font-weight-border mb-1'>
                {{question.voter.count}}                
            </div>
            <a href='#' class = 'recommend btn btn-sm btn-secondary btn-block my-1'
            data-uri="{% url 'yannjuName:vote_question' question.id%}">
            ì¶”ì²œ
            </a>
        </div>
        <div class='col-11'>
            <!--ì§ˆë¬¸ ì˜ì—­-->
            <!--card ë¥¼ ì´ìš©í•˜ì—¬ ì‚¬ì§„ ë“± ì²¨ë¶€ ê°€ëŠ¥ : ex. yout ube ì¸ë„¤ì¼-->
            <div class = "card">
                <div class = "card-body">
                    <!--white space : ê³µë°±, ê°œí–‰ ë“±ë“± ì„ ì‘ì„±í•œ ê·¸ëŒ€ë¡œ-->
                    {% comment %} <div class = "card-text" style = "white-space : pre-line;"> {% endcomment %}
                    <div class = "card-text"> 
                        {{question.content|mark}}
                        {% comment %} {{question.content}} {% endcomment %}
                    </div>

                    {% include './comment_question.html' %}

                    <!--floatì™€ ë¹„ìŠ·í•˜ê²Œ ì •ë ¬-->
                    <div class = "d-flex justify-content-end">
                        <!--badge : ì‚¬ê°í˜•ìœ¼ë¡œ ë‘˜ëŸ¬ìŒˆ-->
                        {% if question.modify_date %}
                            <div class = "badge badge-light p-2 text-left mx-3">
                                <div class = 'mb-2' >Modified at</div>  
                                <div> {{question.modify_date}} </div> 
                            </div>
                        {% endif %}
                        <div class = "badge badge-light p-2">
                            {% comment %} <div class='mb-2'>{{question.auth.username}}</div> {% endcomment %}
                            <div>{{question.create_date}}</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    {% include './answer_list.html' %}
    {% comment %} <a href = "{% url 'index' %}">ëª©ë¡ë³´ê¸°</a> {% endcomment %}
    <a href = "{% url 'yannjuName:index' %}">ëª©ë¡ë³´ê¸°</a> <!--ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì„¤ì •-->

    <form action="{% url 'yannjuName:answer_create' question.id %}" method="post">
    {% comment %} <form action="" method="post"> {% endcomment %}
        {% csrf_token %}
        {% if form.errors %}
        <div class = "alert alert-danger" role = "alert">
            {% for field in form %}
                {% if field.errors and field.label == 'ë‹µë³€ ë‚´ìš©'%}
                    <strong>{{field.label}}</strong>
                    {{field.errors}}
                {% endif %}
            {% endfor %}
        </div>
        {% endif %}

        <div class = "form-group"> <!-- ë¡œê·¸ì¸ ì—†ì´ ë‹µë³€ ë¶ˆê°€-->
            <textarea {% if not user.is_authenticated %} disabled='disabled'{% endif %} 
            name="content" id="content" class = 'form-control' rows="8"></textarea>
        </div>
        <input {% if not user.is_authenticated %} disabled='disabled'{% endif %} 
        type="submit" value="ë‹µë³€ë“±ë¡" class = 'btn btn-secondary'>
    </form>    
</div>

<div>
    {% autoescape off %}
        {{ object.content }}
    {% endautoescape %} 
</div>
{% endblock content %}

{% block script %}
<script>
    $(document).ready(function(){
        /* Delete */
        $(".delete").on("click", function() {
            if (confirm("ì •ë§ë¡œ ì‚­ì œ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                location.href = $(this).data('uri');
            }
        });
        
        /* Recommend */
        $(".recommend").on("click", function() {
            if (confirm("ì¶”ì²œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ğŸ‘ğŸ»")) {
                location.href = $(this).data('uri');
            }
        });
    });
</script>
{% endblock script %}